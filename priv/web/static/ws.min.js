const WS_KEEPALIVE_TIME=20*1000;const WS_KEEPALIVE_INTVL=10*1000;const WS_KEEPALIVE_PROBES=3;const WS_RECONN_INTVL=20*1000;var ws={wsHost:null,onOpen:null,onClose:null,onMessage:null,onError:null,websocket:null,tmping:null,tmreconn:null,probs:0};ws.connect=function(c,b,a,e,d){ws.wsHost=c;ws.onOpen=b;ws.onClose=a;ws.onMessage=e;ws.onError=d;if(!ws.tmreconn){ws.tmreconn=window.setInterval(ws.reconnect,WS_RECONN_INTVL)}ws.disconnect();ws.websocket=new WebSocket(c);ws.websocket.onopen=function(f){ws.probs=0;ws.ping();b(f)};ws.websocket.onclose=function(f){a(f);ws.disconnect()};ws.websocket.onmessage=function(f){ws.resetPingPong();if(f.data=="#ping#"){ws.pong()}else{if(f.data=="#pong#"){}else{e(f)}}};ws.websocket.onerror=function(f){d(f);ws.disconnect()}};ws.reconnect=function(){if(!ws.isConnect()){ws.connect(ws.wsHost,ws.onOpen,ws.onClose,ws.onMessage,ws.onError)}};ws.disconnect=function(){if(ws.websocket){try{ws.websocket.close();window.clearTimeout(ws.tmping);ws.websocket=null}catch(a){}}};ws.isConnect=function(){return ws.websocket&&ws.websocket.readyState==ws.websocket.OPEN};ws.ping=function(){try{window.clearTimeout(ws.tmping)}catch(a){}if(ws.probs>=WS_KEEPALIVE_PROBES){ws.disconnect()}else{if(ws.probs<1){idle=WS_KEEPALIVE_TIME}else{idle=WS_KEEPALIVE_INTVL}ws.tmping=window.setTimeout(ws.ping,idle);ws.probs=ws.probs+1;ws.send("#ping#")}};ws.pong=function(){ws.resetPingPong();ws.send("#pong#")};ws.resetPingPong=function(){try{window.clearTimeout(ws.tmping)}catch(a){}ws.probs=0;ws.tmping=window.setTimeout(ws.ping,WS_KEEPALIVE_TIME)};ws.send=function(b){var a=false;if(b==null||b==undefined||ws.trim(b)==""){a=true}else{if(ws.isConnect()){ws.websocket.send(b);a=true}}return a};ws.trim=function(a){a=a.replace(/^\s\s*/,""),wss=/\s/,i=a.length;while(wss.test(a.charAt(--i))){}return a.slice(0,i+1)};